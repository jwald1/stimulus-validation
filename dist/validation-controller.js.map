{"version":3,"file":"validation-controller.js","sources":["../node_modules/@babel/runtime/helpers/classCallCheck.js","../node_modules/@babel/runtime/helpers/createClass.js","../node_modules/@babel/runtime/helpers/typeof.js","../node_modules/@babel/runtime/helpers/assertThisInitialized.js","../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js","../node_modules/@babel/runtime/helpers/getPrototypeOf.js","../node_modules/@babel/runtime/helpers/setPrototypeOf.js","../node_modules/@babel/runtime/helpers/inherits.js","../node_modules/@babel/runtime/helpers/defineProperty.js","../node_modules/@babel/runtime/helpers/arrayWithHoles.js","../node_modules/@babel/runtime/helpers/iterableToArrayLimit.js","../node_modules/@babel/runtime/helpers/nonIterableRest.js","../node_modules/@babel/runtime/helpers/slicedToArray.js","../src/attribute.js","../src/element_attribute.js","../src/attributes.js","../src/errors.js","../node_modules/@babel/runtime/helpers/arrayWithoutHoles.js","../node_modules/@babel/runtime/helpers/iterableToArray.js","../node_modules/@babel/runtime/helpers/nonIterableSpread.js","../node_modules/@babel/runtime/helpers/toConsumableArray.js","../src/validator.js","../src/validation_controller.js"],"sourcesContent":["function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","function _typeof2(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof2 = function _typeof2(obj) { return typeof obj; }; } else { _typeof2 = function _typeof2(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof2(obj); }\n\nfunction _typeof(obj) {\n  if (typeof Symbol === \"function\" && _typeof2(Symbol.iterator) === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return _typeof2(obj);\n    };\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : _typeof2(obj);\n    };\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;","function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nmodule.exports = _assertThisInitialized;","var _typeof = require(\"../helpers/typeof\");\n\nvar assertThisInitialized = require(\"./assertThisInitialized\");\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}\n\nmodule.exports = _possibleConstructorReturn;","function _getPrototypeOf(o) {\n  module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nmodule.exports = _getPrototypeOf;","function _setPrototypeOf(o, p) {\n  module.exports = _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nmodule.exports = _setPrototypeOf;","var setPrototypeOf = require(\"./setPrototypeOf\");\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}\n\nmodule.exports = _inherits;","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nmodule.exports = _arrayWithHoles;","function _iterableToArrayLimit(arr, i) {\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nmodule.exports = _iterableToArrayLimit;","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}\n\nmodule.exports = _nonIterableRest;","var arrayWithHoles = require(\"./arrayWithHoles\");\n\nvar iterableToArrayLimit = require(\"./iterableToArrayLimit\");\n\nvar nonIterableRest = require(\"./nonIterableRest\");\n\nfunction _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || nonIterableRest();\n}\n\nmodule.exports = _slicedToArray;","export class Attribute {\n  constructor(attribute, el, validators) {\n    this.attribute = attribute\n    this.el = el\n    this.validators = validators\n  }\n\n  get value() {\n    return this.el.type === \"checkbox\" ? this.el.checked : this.el.value\n  }\n\n  get validationMethods() {\n    const result = []\n\n    Object.entries(this.validators).forEach(([methodName, { attributes }]) => {\n      if (attributes.includes(this.attribute)) {\n        result.push(methodName)\n      }\n    })\n\n    return result\n  }\n}\n","export function attributeFromElement(el) {\n  let value = el.dataset.attr\n  attributeNotFound(value)\n\n  value = value.split(\".\")[1]\n  attributeNotFound(value)\n\n  return value\n}\n\nfunction attributeNotFound(value) {\n  if (!value) {\n    throw new Error(\"We can't find attribute name. Please add data-attr\")\n  }\n}\n","import { Attribute } from \"./attribute\"\nimport { attributeFromElement } from \"./element_attribute\"\n\nexport class Attributes {\n  constructor(controller) {\n    this.controller = controller\n    this.dataMap = new Map()\n\n    this.createAttributesMap()\n  }\n\n  get(attribute) {\n    return this.dataMap.get(attribute)\n  }\n\n  createAttributesMap() {\n    this.validationElements.forEach(el => {\n      const attrName = attributeFromElement(el)\n\n      this.add(attrName, el)\n    })\n  }\n\n  get size() {\n    return this.dataMap.size\n  }\n\n  refresh() {\n    this.createAttributesMap()\n  }\n\n  has(value) {\n    return this.dataMap.has(value)\n  }\n\n  add(attrName, el, validators = this.validators) {\n    const attribute = new Attribute(attrName, el, validators)\n    this.dataMap.set(attrName, attribute)\n\n    return attribute\n  }\n\n  forEach(...args) {\n    return this.dataMap.forEach(...args)\n  }\n\n  get validationElements() {\n    return this.element.querySelectorAll(`[data-attr^=\"${this.identifier}.\"]`)\n  }\n\n  get identifier() {\n    return this.controller.identifier\n  }\n\n  get element() {\n    return this.controller.element\n  }\n\n  get validators() {\n    return this.controller.constructor.validators\n  }\n}\n","export class Errors {\n  constructor() {\n    this.dataMap = new Map()\n  }\n\n  clear() {\n    return this.dataMap.clear()\n  }\n\n  get size() {\n    const arrayOfmessages = Array.from(this.dataMap.values())\n\n    return arrayOfmessages.reduce(\n      (total, messages) => (total += messages.length),\n      0\n    )\n  }\n\n  hasAny() {\n    return !!this.size\n  }\n\n  has(attribute) {\n    return this.dataMap.has(attribute)\n  }\n\n  get(attribute) {\n    return this.dataMap.get(attribute)\n  }\n\n  add(attribute, message) {\n    const attributesMessages = this.dataMap.get(attribute) || []\n    attributesMessages.push(message)\n\n    this.dataMap.set(attribute, attributesMessages)\n  }\n\n  clearAttribute(attribute) {\n    this.dataMap.delete(attribute)\n  }\n\n  forEach(...args) {\n    return this.dataMap.forEach(...args)\n  }\n}\n","function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n}\n\nmodule.exports = _arrayWithoutHoles;","function _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}\n\nmodule.exports = _iterableToArray;","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\n\nmodule.exports = _nonIterableSpread;","var arrayWithoutHoles = require(\"./arrayWithoutHoles\");\n\nvar iterableToArray = require(\"./iterableToArray\");\n\nvar nonIterableSpread = require(\"./nonIterableSpread\");\n\nfunction _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || nonIterableSpread();\n}\n\nmodule.exports = _toConsumableArray;","import Validate from \"validate.js\"\n\nexport class Validator {\n  constructor(controller) {\n    this.controller = controller\n  }\n\n  static get validatejs() {\n    return Validate\n  }\n\n  run(attribute) {\n    this.errors.clearAttribute(attribute)\n\n    this.validateRule(attribute)\n    this.invokeValidationMethods(attribute)\n  }\n\n  validateRule(attribute) {\n    const params = this.validatejsParams(attribute)\n\n    if (!params) {\n      return\n    }\n\n    const messages = this.constructor.validatejs(...params)\n    if (messages) {\n      messages[attribute].forEach(message =>\n        this.errors.add(attribute, message)\n      )\n    }\n  }\n\n  invokeValidationMethods(attribute) {\n    const { el, value, validationMethods } = this.attributes.get(attribute)\n\n    validationMethods.forEach(methodName => {\n      const method = this.controller[methodName]\n\n      if (!method) {\n        throw new Error(`${methodName} is not defined`)\n      }\n\n      method.call(this.controller, { attr: attribute, value, el })\n    })\n  }\n\n  validatejsParams(attribute) {\n    const rule = this.rules[attribute]\n\n    if (!rule) {\n      return\n    }\n\n    const { value } = this.attributes.get(attribute)\n    const validateValue = {\n      [attribute]: value,\n    }\n\n    if (rule.equality) {\n      const anotherAttribute = rule.equality.attribute\n      const { value } = this.attributes.get(anotherAttribute)\n      validateValue[anotherAttribute] = value\n    }\n\n    return [validateValue, { [attribute]: this.rules[attribute] }]\n  }\n\n  get rules() {\n    return this.controller.constructor.rules\n  }\n\n  get errors() {\n    return this.controller.errors\n  }\n\n  get attributes() {\n    return this.controller.attributes\n  }\n}\n","import { Controller } from \"stimulus\"\nimport { Attributes } from \"./attributes\"\nimport { Errors } from \"./errors\"\nimport { Validator } from \"./validator\"\nimport { attributeFromElement } from \"./element_attribute\"\n\nexport class ValidationController extends Controller {\n  static rules = {} // overwirde in subclass\n  static validators = [] // overwirde in subclass\n\n  connect() {\n    this.errors = new Errors()\n    this.attributes = new Attributes(this)\n    this._validator = new Validator(this)\n  }\n\n  validate(event) {\n    const el = event.currentTarget\n    const attribute = attributeFromElement(el)\n\n    if (!this.attributes.has(attribute)) {\n      this.attributes.add(attribute, el)\n    }\n\n    const { value } = this.attributes.get(attribute)\n\n    this.runValidator(attribute)\n    this.afterValidate({ el, attr: attribute, value })\n  }\n\n  afterValidate(attribute) {\n    // overwirde in subclass\n  }\n\n  afterValidateAll(event) {\n    // overwirde in subclass\n  }\n\n  runValidator(attribute) {\n    this._validator.run(attribute)\n  }\n\n  validateAll(event) {\n    this.attributes.refresh()\n    this.errors.clear()\n\n    this.attributes.forEach(({ el, value }, attribute) => {\n      this.runValidator(attribute)\n\n      if (this.errors.hasAny()) {\n        event.preventDefault()\n      }\n      this.afterValidate({ el, attr: attribute, value })\n    })\n\n    this.afterValidateAll(event)\n  }\n\n  get validatejs() {\n    return Validator.validatejs\n  }\n\n  static get validatejs() {\n    return Validator.validatejs\n  }\n}\n"],"names":["_typeof","Attribute","attribute","el","validators","type","checked","value","result","Object","entries","forEach","methodName","attributes","includes","push","attributeFromElement","dataset","attr","attributeNotFound","split","Error","Attributes","controller","dataMap","Map","createAttributesMap","get","validationElements","attrName","add","has","set","size","element","querySelectorAll","identifier","constructor","Errors","clear","message","attributesMessages","delete","arrayOfmessages","Array","from","values","reduce","total","messages","length","Validator","errors","clearAttribute","validateRule","invokeValidationMethods","params","validatejsParams","validatejs","validationMethods","method","call","rule","rules","validateValue","equality","anotherAttribute","Validate","ValidationController","_validator","event","currentTarget","runValidator","afterValidate","run","refresh","hasAny","preventDefault","afterValidateAll","Controller"],"mappings":"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"}